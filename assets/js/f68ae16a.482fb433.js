"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3507],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var i=n.createContext({}),l=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=l(e.components);return n.createElement(i.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),p=l(a),h=r,m=p["".concat(i,".").concat(h)]||p[h]||d[h]||s;return a?n.createElement(m,o(o({ref:t},c),{},{components:a})):n.createElement(m,o({ref:t},c))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=a.length,o=new Array(s);o[0]=p;var u={};for(var i in t)hasOwnProperty.call(t,i)&&(u[i]=t[i]);u.originalType=e,u.mdxType="string"==typeof e?e:r,o[1]=u;for(var l=2;l<s;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},5162:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7294),r=a(6010);const s="tabItem_Ymn6";function o(e){var t=e.children,a=e.hidden,o=e.className;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(s,o),hidden:a},t)}},5488:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(7462),r=a(7294),s=a(6010),o=a(2389),u=a(7392),i=a(7094),l=a(2466);const c="tabList__CuJ",d="tabItem_LNqP";function p(e){var t,a,o=e.lazy,p=e.block,h=e.defaultValue,m=e.values,w=e.groupId,q=e.className,f=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),g=null!=m?m:f.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),v=(0,u.l)(g,(function(e,t){return e.value===t.value}));if(v.length>0)throw new Error('Docusaurus error: Duplicate values "'+v.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var y=null===h?h:null!=(t=null!=h?h:null==(a=f.find((function(e){return e.props.default})))?void 0:a.props.value)?t:f[0].props.value;if(null!==y&&!g.some((function(e){return e.value===y})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+y+'" but none of its children has the corresponding value. Available values are: '+g.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var k=(0,i.U)(),b=k.tabGroupChoices,R=k.setTabGroupChoices,x=(0,r.useState)(y),N=x[0],T=x[1],C=[],L=(0,l.o5)().blockElementScrollPositionUntilNextRender;if(null!=w){var E=b[w];null!=E&&E!==N&&g.some((function(e){return e.value===E}))&&T(E)}var I=function(e){var t=e.currentTarget,a=C.indexOf(t),n=g[a].value;n!==N&&(L(t),T(n),null!=w&&R(w,String(n)))},O=function(e){var t,a=null;switch(e.key){case"ArrowRight":var n,r=C.indexOf(e.currentTarget)+1;a=null!=(n=C[r])?n:C[0];break;case"ArrowLeft":var s,o=C.indexOf(e.currentTarget)-1;a=null!=(s=C[o])?s:C[C.length-1]}null==(t=a)||t.focus()};return r.createElement("div",{className:(0,s.Z)("tabs-container",c)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":p},q)},g.map((function(e){var t=e.value,a=e.label,o=e.attributes;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,key:t,ref:function(e){return C.push(e)},onKeyDown:O,onFocus:I,onClick:I},o,{className:(0,s.Z)("tabs__item",d,null==o?void 0:o.className,{"tabs__item--active":N===t})}),null!=a?a:t)}))),o?(0,r.cloneElement)(f.filter((function(e){return e.props.value===N}))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},f.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==N})}))))}function h(e){var t=(0,o.Z)();return r.createElement(p,(0,n.Z)({key:String(t)},e))}},4959:(e,t,a)=>{a.d(t,{Z:()=>u});var n=a(7294),r=a(9960),s=a(4477),o=a(2263);const u=function(e){var t=e.to,a=e.children,u=(0,s.E)();return(0,o.default)().siteConfig.presets[0][1].docs.disableVersioning?n.createElement(r.default,{to:"/api/"+t},a):n.createElement(r.default,{to:"/api/"+("current"===u.version?"next":u.version)+"/"+t},a)}},3742:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>m,contentTitle:()=>p,default:()=>f,frontMatter:()=>d,metadata:()=>h,toc:()=>w});var n=a(7462),r=a(3366),s=(a(7294),a(3905)),o=a(4959),u=a(5488),i=a(5162),l=a(1435);var c=["components"],d={id:"request-storage",title:"Request Storage",description:"How to store the requests your crawler will go through"},p=void 0,h={unversionedId:"guides/request-storage",id:"guides/request-storage",title:"Request Storage",description:"How to store the requests your crawler will go through",source:"@site/../docs/guides/request_storage.mdx",sourceDirName:"guides",slug:"/guides/request-storage",permalink:"/docs/guides/request-storage",draft:!1,tags:[],version:"current",lastUpdatedBy:"Andrey Bykov",lastUpdatedAt:1657805876,formattedLastUpdatedAt:"7/14/2022",frontMatter:{id:"request-storage",title:"Request Storage",description:"How to store the requests your crawler will go through"},sidebar:"docs",previous:{title:"Motivation",permalink:"/docs/"},next:{title:"Result Storage",permalink:"/docs/guides/result-storage"}},m={},w=[{value:"Request queue",id:"request-queue",level:2},{value:"Request list",id:"request-list",level:2},{value:"Which one to choose?",id:"which-one-to-choose",level:2},{value:"Cleaning up the storages",id:"cleaning-up-the-storages",level:2}],q={toc:w};function f(e){var t=e.components,a=(0,r.Z)(e,c);return(0,s.kt)("wrapper",(0,n.Z)({},q,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"Crawlee has several request storage types that are useful for specific tasks. The requests are stored on local disk to a directory defined by the ",(0,s.kt)("inlineCode",{parentName:"p"},"CRAWLEE_STORAGE_DIR")," environment variable. If this variable is not defined, by default Crawlee sets ",(0,s.kt)("inlineCode",{parentName:"p"},"CRAWLEE_STORAGE_DIR")," to ",(0,s.kt)("inlineCode",{parentName:"p"},"./crawlee_storage")," in the current working directory."),(0,s.kt)("h2",{id:"request-queue"},"Request queue"),(0,s.kt)("p",null,"The request queue is a storage of URLs to crawl. The queue is used for the deep crawling of websites, where we start with several URLs and then recursively follow links to other pages. The data structure supports both breadth-first and depth-first crawling orders."),(0,s.kt)("p",null,"Each Crawlee project run is associated with a ",(0,s.kt)("strong",{parentName:"p"},"default request queue"),". Typically, it is used to store URLs to crawl in the specific crawler run. Its usage is optional."),(0,s.kt)("p",null,"In Crawlee, the request queue is represented by the ",(0,s.kt)(o.Z,{to:"core/class/RequestQueue",mdxType:"ApiLink"},(0,s.kt)("inlineCode",{parentName:"p"},"RequestQueue"))," class."),(0,s.kt)("p",null,"The request queue is managed by ",(0,s.kt)(o.Z,{to:"memory-storage/class/MemoryStorage",mdxType:"ApiLink"},(0,s.kt)("inlineCode",{parentName:"p"},"MemoryStorage"))," class and its data is stored in memory, while also being off-loaded to the local directory specified by the ",(0,s.kt)("inlineCode",{parentName:"p"},"CRAWLEE_STORAGE_DIR")," environment variable as follows:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"{CRAWLEE_STORAGE_DIR}/request_queues/{QUEUE_ID}/entries.json\n")),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},(0,s.kt)("inlineCode",{parentName:"p"},"{QUEUE_ID}")," is the name or ID of the request queue. The default queue has ID ",(0,s.kt)("inlineCode",{parentName:"p"},"default"),", unless we override it by setting the ",(0,s.kt)("inlineCode",{parentName:"p"},"CRAWLEE_DEFAULT_REQUEST_QUEUE_ID")," environment variable."))),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},(0,s.kt)("inlineCode",{parentName:"p"},"entries.json")," contains an array or requests."))),(0,s.kt)("p",null,"The following code demonstrates the usage of the request queue:"),(0,s.kt)(u.Z,{groupId:"request_queue",mdxType:"Tabs"},(0,s.kt)(i.Z,{value:"crawler",label:"Usage with Crawler",default:!0,mdxType:"TabItem"},(0,s.kt)(l.Z,{language:"js",mdxType:"CodeBlock"},"import { CheerioCrawler } from 'crawlee';\n\n// The crawler will automatically process requests from the queue.\n// It's used the same way for Puppeteer/Playwright crawlers.\nconst crawler = new CheerioCrawler({\n    // Note that we're not specifying the requestQueue here\n    async requestHandler({ $, crawler, enqueueLinks }) {\n        // Add new request to the queue\n        await crawler.addRequests([{ url: 'https://example.com/new-page' }]);\n        // Add links found on page to the queue\n        await enqueueLinks();\n    },\n});\n\n// Add the initial requests.\n// Note that we are not opening the request queue explicitly before\nawait crawler.addRequests([\n    { url: 'https://example.com/1' },\n    { url: 'https://example.com/2' },\n    { url: 'https://example.com/3' },\n    // ...\n]);\n\n// Run the crawler\nawait crawler.run();\n")),(0,s.kt)(i.Z,{value:"crawler_explicit",label:"Explicit usage with Crawler",mdxType:"TabItem"},(0,s.kt)(l.Z,{language:"js",mdxType:"CodeBlock"},"import { RequestQueue, CheerioCrawler } from 'crawlee';\n\n// Open the default request queue associated with the current run\nconst requestQueue = await RequestQueue.open();\n\n// Enqueue the initial requests\nawait requestQueue.addRequests([\n    { url: 'https://example.com/1' },\n    { url: 'https://example.com/2' },\n    { url: 'https://example.com/3' },\n    // ...\n]);\n\n// The crawler will automatically process requests from the queue.\n// It's used the same way for Puppeteer/Playwright crawlers\nconst crawler = new CheerioCrawler({\n    requestQueue,\n    async requestHandler({ $, request, enqueueLinks }) {\n        // Add new request to the queue\n        await requestQueue.addRequests([{ url: 'https://example.com/new-page' }]);\n        // Add links found on page to the queue\n        await enqueueLinks();\n    },\n});\n\n// Run the crawler\nawait crawler.run();\n")),(0,s.kt)(i.Z,{value:"basic_operations",label:"Basic Operations",default:!0,mdxType:"TabItem"},(0,s.kt)(l.Z,{language:"js",mdxType:"CodeBlock"},"import { RequestQueue } from 'crawlee';\n\n// Open the default request queue associated with the crawler run\nconst requestQueue = await RequestQueue.open();\n\n// Enqueue the initial batch of requests (could be an array of just one)\nawait requestQueue.addRequests([\n    { url: 'https://example.com/1' },\n    { url: 'https://example.com/2' },\n    { url: 'https://example.com/3' },\n]);\n\n// Open the named request queue\nconst namedRequestQueue = await RequestQueue.open('named-queue');\n\n// Remove the named request queue\nawait namedRequestQueue.drop();\n"))),(0,s.kt)("p",null,"To see more detailed example of how to use the request queue with a crawler, see the ",(0,s.kt)("a",{parentName:"p",href:"/docs/examples/puppeteer-crawler",target:null,rel:null},"Puppeteer Crawler")," example."),(0,s.kt)("h2",{id:"request-list"},"Request list"),(0,s.kt)("p",null,"The request list is not a storage per se - it represents the list of URLs to crawl that is stored in a crawler run memory (or optionally in default ",(0,s.kt)("a",{parentName:"p",href:"../guides/result-storage#key-value-store",target:null,rel:null},"Key-Value Store")," associated with the run, if specified). The list is used for the crawling of a large number of URLs, when we know all the URLs which should be visited by the crawler and no URLs would be added during the run. The URLs can be provided either in code or parsed from a text file hosted on the web."),(0,s.kt)("p",null,"Request list is created exclusively for the crawler run and only if its usage is explicitly specified in the code. Its usage is optional."),(0,s.kt)("p",null,"In Crawlee, the request list is represented by the ",(0,s.kt)(o.Z,{to:"core/class/RequestList",mdxType:"ApiLink"},(0,s.kt)("inlineCode",{parentName:"p"},"RequestList"))," class."),(0,s.kt)("p",null,"The following code demonstrates basic operations of the request list:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},"import { RequestList, PuppeteerCrawler } from 'crawlee';\n\n// Prepare the sources array with URLs to visit\nconst sources = [\n    { url: 'http://www.example.com/page-1' },\n    { url: 'http://www.example.com/page-2' },\n    { url: 'http://www.example.com/page-3' },\n];\n\n// Open the request list.\n// List name is used to persist the sources and the list state in the key-value store\nconst requestList = await RequestList.open('my-list', sources);\n\n// The crawler will automatically process requests from the list\n// It's used the same way for Cheerio /Playwright crawlers.\nconst crawler = new PuppeteerCrawler({\n    requestList,\n    async requestHandler({ page, request }) {\n        // Process the page (extract data, take page screenshot, etc).\n        // No more requests could be added to the request list here\n    },\n});\n")),(0,s.kt)("p",null,"To see more detailed example of how to use the request list with a crawler, see the ",(0,s.kt)("a",{parentName:"p",href:"/docs/examples/puppeteer-with-proxy",target:null,rel:null},"Puppeteer with proxy")," example."),(0,s.kt)("h2",{id:"which-one-to-choose"},"Which one to choose?"),(0,s.kt)("p",null,"When using Request queue - we would normally have several start URLs (e.g. category pages on e-commerce website) and then recursively add more (e.g. individual item pages) programmatically to the queue, it supports dynamic adding and removing of requests. No more URLs can be added to Request list after its initialization as it is immutable, URLs cannot be removed from the list either."),(0,s.kt)("p",null,"On the other hand, the Request queue is not optimized for adding or removing numerous URLs in a batch. This is technically possible, but requests are added one by one to the queue, and thus it would take significant time with a larger number of requests. Request list however can contain even millions of URLs, and it would take significantly less time to add them to the list, compared to the queue."),(0,s.kt)("p",null,"Note that Request queue and Request list can be used together by the same crawler. In such cases, each request from the Request list is enqueued into the Request queue first (to the foremost position in the queue, even if Request queue is not empty) and then consumed from the latter. This is necessary to avoid the same URL being processed more than once (from the list first and then possibly from the queue). In practical terms, such a combination can be useful when there are numerous initial URLs, but more URLs would be added dynamically by the crawler."),(0,s.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"In Crawlee, there is no much need to combine the request queue together with the request list (although it's technically possible)."),(0,s.kt)("p",{parentName:"div"},"Previously there was no way to add the initial requests to the queue in batches (to add an array of requests), i.e. we could have only added the requests one by one to the queue with the help of ",(0,s.kt)(o.Z,{to:"core/class/RequestQueue#addRequest",mdxType:"ApiLink"},(0,s.kt)("inlineCode",{parentName:"p"},"addRequest()"))," function."),(0,s.kt)("p",{parentName:"div"},"However, now we could use the ",(0,s.kt)(o.Z,{to:"core/class/RequestQueue#addRequests",mdxType:"ApiLink"},(0,s.kt)("inlineCode",{parentName:"p"},"addRequests()"))," function, which adds requests in batches. Thus, instead of combining the request queue and the request list, we can use only the request queue for such use-cases now. See the examples below."))),(0,s.kt)(u.Z,{groupId:"queue_list",mdxType:"Tabs"},(0,s.kt)(i.Z,{value:"add_requests",label:"Request Queue",default:!0,mdxType:"TabItem"},(0,s.kt)(l.Z,{language:"js",mdxType:"CodeBlock"},"// This is the suggested way.\n// Note that we are not using the request list at all,\n// and not using the request queue explicitly here.\n\nimport { PuppeteerCrawler } from 'crawlee';\n\n// Prepare the sources array with URLs to visit (it can contain millions of URLs)\nconst sources = [\n    { url: 'http://www.example.com/page-1' },\n    { url: 'http://www.example.com/page-2' },\n    { url: 'http://www.example.com/page-3' },\n    // ...\n];\n\n// The crawler will automatically process requests from the queue.\n// It's used the same way for Cheerio/Playwright crawlers\nconst crawler = new PuppeteerCrawler({\n    async requestHandler({ crawler, enqueueLinks }) {\n        // Add new request to the queue\n        await crawler.addRequests(['http://www.example.com/new-page']);\n\n        // Add links found on page to the queue\n        await enqueueLinks();\n\n        // The requests above would be added to the queue\n        // and would be processed after the initial requests are processed.\n    },\n});\n\n// Add the initial sources array to the request queue\n// and run the crawler\nawait crawler.run(sources);\n")),(0,s.kt)(i.Z,{value:"queue_list",label:"Request Queue + Request List",mdxType:"TabItem"},(0,s.kt)(l.Z,{language:"js",mdxType:"CodeBlock"},"// This is technically correct, but\n// we need to explicitly open/use both the request queue and the request list.\n// We suggest using the request queue and batch add the requests instead.\n\nimport { RequestList, RequestQueue, PuppeteerCrawler } from 'crawlee';\n\n// Prepare the sources array with URLs to visit (it can contain millions of URLs)\nconst sources = [\n    { url: 'http://www.example.com/page-1' },\n    { url: 'http://www.example.com/page-2' },\n    { url: 'http://www.example.com/page-3' },\n    // ...\n];\n\n// Open the request list with the initial sources array\nconst requestList = await RequestList.open('my-list', sources);\n\n// Open the default request queue. It's not necessary to add any requests to the queue\nconst requestQueue = await RequestQueue.open();\n\n// The crawler will automatically process requests from the list and the queue.\n// It's used the same way for Cheerio/Playwright crawlers\nconst crawler = new PuppeteerCrawler({\n    requestList,\n    requestQueue,\n    // Each request from the request list is enqueued to the request queue one by one.\n    // At this point request with the same URL would exist in the list and the queue\n    async requestHandler({ crawler, enqueueLinks }) {\n        // Add new request to the queue\n        await crawler.addRequests(['http://www.example.com/new-page']);\n\n        // Add links found on page to the queue\n        await enqueueLinks();\n\n        // The requests above would be added to the queue (but not to the list)\n        // and would be processed after the request list is empty.\n        // No more requests could be added to the list here\n    },\n});\n\n// Run the crawler\nawait crawler.run();\n"))),(0,s.kt)("h2",{id:"cleaning-up-the-storages"},"Cleaning up the storages"),(0,s.kt)("p",null,"Default storages are purged before the crawler starts if not specified otherwise. This happens as early as when we try to open some storage (e.g. via ",(0,s.kt)("inlineCode",{parentName:"p"},"RequestQueue.open()"),") or when we try to work with a default storage via one of the helper methods (e.g. ",(0,s.kt)("inlineCode",{parentName:"p"},"crawler.addRequests()")," that under the hood calls ",(0,s.kt)("inlineCode",{parentName:"p"},"RequestQueue.open()"),"). If we don't work with storages explicitly in our code, the purging will eventually happen when the ",(0,s.kt)("inlineCode",{parentName:"p"},"run")," method of our crawler is executed. In case we need to purge the storages sooner, we can use the ",(0,s.kt)(o.Z,{to:"core/function/purgeDefaultStorages",mdxType:"ApiLink"},(0,s.kt)("inlineCode",{parentName:"p"},"purgeDefaultStorages()"))," helper explicitly:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-javascript"},"import { purgeDefaultStorages } from 'crawlee';\n\nawait purgeDefaultStorages();\n")),(0,s.kt)("p",null,"Calling this function will clean up the default request storage directory (and also the request list stored in default key-value store). This is a shortcut for running (optional) ",(0,s.kt)("inlineCode",{parentName:"p"},"purge")," method on the ",(0,s.kt)(o.Z,{to:"core/interface/StorageClient",mdxType:"ApiLink"},(0,s.kt)("inlineCode",{parentName:"p"},"StorageClient"))," interface, in other words it will call the ",(0,s.kt)("inlineCode",{parentName:"p"},"purge")," method of the underlying storage implementation we are currently using. In addition, this method will make sure the storage is purged only once for a given execution context, so it is safe to call it multiple times."))}f.isMDXComponent=!0}}]);